# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'form_for_sniffer_version5.ui'
#
# Created by: PyQt5 UI code generator 5.15.9
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.


from PyQt5 import QtCore, QtGui, QtWidgets
import logging # Добавлено для TextEditLogger
from PyQt5.QtWidgets import QPlainTextEdit # Добавлено для TextEditLogger
from PyQt5.QtCore import QTimer # Добавлено для TextEditLogger

class Ui_tableWidget_metrics(object):
    def setupUi(self, tableWidget_metrics):
        tableWidget_metrics.setObjectName("tableWidget_metrics")
        tableWidget_metrics.resize(1827, 1106)
        self.label_name_of_work = QtWidgets.QLabel(tableWidget_metrics)
        self.label_name_of_work.setGeometry(QtCore.QRect(450, 20, 851, 71))
        font = QtGui.QFont()
        font.setPointSize(22)
        self.label_name_of_work.setFont(font)
        self.label_name_of_work.setObjectName("label_name_of_work")
        self.pushBatton_start_capture = QtWidgets.QPushButton(tableWidget_metrics)
        self.pushBatton_start_capture.setGeometry(QtCore.QRect(10, 320, 161, 51))
        font = QtGui.QFont()
        font.setPointSize(14)
        font.setBold(False)
        font.setWeight(50)
        self.pushBatton_start_capture.setFont(font)
        self.pushBatton_start_capture.setObjectName("pushBatton_start_capture")
        self.pushButton_stop_capture = QtWidgets.QPushButton(tableWidget_metrics)
        self.pushButton_stop_capture.setGeometry(QtCore.QRect(500, 320, 161, 51))
        font = QtGui.QFont()
        font.setPointSize(14)
        font.setBold(False)
        font.setWeight(50)
        self.pushButton_stop_capture.setFont(font)
        self.pushButton_stop_capture.setObjectName("pushButton_stop_capture")
        self.label_name_capture_display = QtWidgets.QLabel(tableWidget_metrics)
        self.label_name_capture_display.setGeometry(QtCore.QRect(210, 320, 261, 41))
        font = QtGui.QFont()
        font.setPointSize(14)
        font.setBold(False)
        font.setWeight(50)
        self.label_name_capture_display.setFont(font)
        self.label_name_capture_display.setObjectName("label_name_capture_display")
        self.label_input_data = QtWidgets.QLabel(tableWidget_metrics)
        self.label_input_data.setGeometry(QtCore.QRect(10, 100, 241, 71))
        font = QtGui.QFont()
        font.setPointSize(18)
        self.label_input_data.setFont(font)
        self.label_input_data.setObjectName("label_input_data")
        self.plainTextEdit = QtWidgets.QPlainTextEdit(tableWidget_metrics)
        self.plainTextEdit.setGeometry(QtCore.QRect(10, 380, 651, 301))
        self.plainTextEdit.setObjectName("plainTextEdit")
        self.tableWidget_metric = QtWidgets.QTableWidget(tableWidget_metrics)
        self.tableWidget_metric.setGeometry(QtCore.QRect(10, 750, 1131, 291))
        self.tableWidget_metric.setObjectName("tableWidget_metric")
        self.tableWidget_metric.setColumnCount(9)
        self.tableWidget_metric.setRowCount(0)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_metric.setHorizontalHeaderItem(0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_metric.setHorizontalHeaderItem(1, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_metric.setHorizontalHeaderItem(2, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_metric.setHorizontalHeaderItem(3, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_metric.setHorizontalHeaderItem(4, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_metric.setHorizontalHeaderItem(5, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_metric.setHorizontalHeaderItem(6, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_metric.setHorizontalHeaderItem(7, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_metric.setHorizontalHeaderItem(8, item)
        self.label_data_statistics_of_capture_traffic = QtWidgets.QLabel(tableWidget_metrics)
        self.label_data_statistics_of_capture_traffic.setGeometry(QtCore.QRect(20, 690, 641, 41))
        font = QtGui.QFont()
        font.setPointSize(14)
        font.setBold(False)
        font.setWeight(50)
        self.label_data_statistics_of_capture_traffic.setFont(font)
        self.label_data_statistics_of_capture_traffic.setObjectName("label_data_statistics_of_capture_traffic")
        self.graphWidget_intensity = QtWidgets.QWidget(tableWidget_metrics)
        self.graphWidget_intensity.setGeometry(QtCore.QRect(710, 170, 1101, 251))
        self.graphWidget_intensity.setObjectName("graphWidget_intensity")
        self.graphWidget_traffic_direction = QtWidgets.QWidget(tableWidget_metrics)
        self.graphWidget_traffic_direction.setGeometry(QtCore.QRect(710, 480, 1101, 251))
        self.graphWidget_traffic_direction.setObjectName("graphWidget_traffic_direction")
        self.label_name_graph_of_intensivity = QtWidgets.QLabel(tableWidget_metrics)
        self.label_name_graph_of_intensivity.setGeometry(QtCore.QRect(710, 120, 359, 35))
        font = QtGui.QFont()
        font.setPointSize(14)
        font.setBold(False)
        font.setWeight(50)
        self.label_name_graph_of_intensivity.setFont(font)
        self.label_name_graph_of_intensivity.setObjectName("label_name_graph_of_intensivity")
        self.label_name_graph_of_input_output_traffic = QtWidgets.QLabel(tableWidget_metrics)
        self.label_name_graph_of_input_output_traffic.setGeometry(QtCore.QRect(720, 430, 431, 35))
        font = QtGui.QFont()
        font.setPointSize(14)
        font.setBold(False)
        font.setWeight(50)
        self.label_name_graph_of_input_output_traffic.setFont(font)
        self.label_name_graph_of_input_output_traffic.setObjectName("label_name_graph_of_input_output_traffic")
        self.graphWidget_protocol_distribution = QtWidgets.QWidget(tableWidget_metrics)
        self.graphWidget_protocol_distribution.setGeometry(QtCore.QRect(1170, 780, 641, 311))
        self.graphWidget_protocol_distribution.setObjectName("graphWidget_protocol_distribution")
        self.label_name_tcp_udp_segments_sootcnocheniy = QtWidgets.QLabel(tableWidget_metrics)
        self.label_name_tcp_udp_segments_sootcnocheniy.setGeometry(QtCore.QRect(1170, 740, 431, 35))
        font = QtGui.QFont()
        font.setPointSize(14)
        font.setBold(False)
        font.setWeight(50)
        self.label_name_tcp_udp_segments_sootcnocheniy.setFont(font)
        self.label_name_tcp_udp_segments_sootcnocheniy.setObjectName("label_name_tcp_udp_segments_sootcnocheniy")
        self.pushButton_save_in_file = QtWidgets.QPushButton(tableWidget_metrics)
        self.pushButton_save_in_file.setGeometry(QtCore.QRect(10, 1050, 251, 51))
        font = QtGui.QFont()
        font.setPointSize(14)
        font.setBold(False)
        font.setWeight(50)
        self.pushButton_save_in_file.setFont(font)
        self.pushButton_save_in_file.setObjectName("pushButton_save_in_file")
        self.pushBatton_finish_work = QtWidgets.QPushButton(tableWidget_metrics)
        self.pushBatton_finish_work.setGeometry(QtCore.QRect(890, 1050, 251, 51))
        font = QtGui.QFont()
        font.setPointSize(14)
        font.setBold(False)
        font.setWeight(50)
        self.pushBatton_finish_work.setFont(font)
        self.pushBatton_finish_work.setObjectName("pushBatton_finish_work")
        self.layoutWidget = QtWidgets.QWidget(tableWidget_metrics)
        self.layoutWidget.setGeometry(QtCore.QRect(10, 170, 361, 121))
        self.layoutWidget.setObjectName("layoutWidget")
        self.verticalLayout = QtWidgets.QVBoxLayout(self.layoutWidget)
        self.verticalLayout.setContentsMargins(0, 0, 0, 0)
        self.verticalLayout.setObjectName("verticalLayout")
        self.label_name_time_of_capture = QtWidgets.QLabel(self.layoutWidget)
        font = QtGui.QFont()
        font.setPointSize(14)
        font.setBold(False)
        font.setWeight(50)
        self.label_name_time_of_capture.setFont(font)
        self.label_name_time_of_capture.setObjectName("label_name_time_of_capture")
        self.verticalLayout.addWidget(self.label_name_time_of_capture)
        self.label_interface_of_capture = QtWidgets.QLabel(self.layoutWidget)
        font = QtGui.QFont()
        font.setPointSize(14)
        font.setBold(False)
        font.setWeight(50)
        self.label_interface_of_capture.setFont(font)
        self.label_interface_of_capture.setObjectName("label_interface_of_capture")
        self.verticalLayout.addWidget(self.label_interface_of_capture)
        self.label_name_network_capture = QtWidgets.QLabel(self.layoutWidget)
        font = QtGui.QFont()
        font.setPointSize(14)
        font.setBold(False)
        font.setWeight(50)
        self.label_name_network_capture.setFont(font)
        self.label_name_network_capture.setObjectName("label_name_network_capture")
        self.verticalLayout.addWidget(self.label_name_network_capture)
        self.layoutWidget1 = QtWidgets.QWidget(tableWidget_metrics)
        self.layoutWidget1.setGeometry(QtCore.QRect(370, 170, 291, 121))
        self.layoutWidget1.setObjectName("layoutWidget1")
        self.verticalLayout_2 = QtWidgets.QVBoxLayout(self.layoutWidget1)
        self.verticalLayout_2.setContentsMargins(0, 0, 0, 0)
        self.verticalLayout_2.setObjectName("verticalLayout_2")
        self.spinBox_time_of_capture = QtWidgets.QSpinBox(self.layoutWidget1)
        self.spinBox_time_of_capture.setMaximum(10000)
        self.spinBox_time_of_capture.setObjectName("spinBox_time_of_capture")
        self.verticalLayout_2.addWidget(self.spinBox_time_of_capture)
        # Отметьте, что ComboBox здесь отсутствует. Он будет добавлен в main.py
        self.lineEdit_network_capture = QtWidgets.QLineEdit(self.layoutWidget1)
        self.lineEdit_network_capture.setObjectName("lineEdit_network_capture")
        self.verticalLayout_2.addWidget(self.lineEdit_network_capture)

        self.retranslateUi(tableWidget_metrics)
        QtCore.QMetaObject.connectSlotsByName(tableWidget_metrics)

    def retranslateUi(self, tableWidget_metrics):
        _translate = QtCore.QCoreApplication.translate
        tableWidget_metrics.setWindowTitle(_translate("tableWidget_metrics", "Диалог"))
        self.label_name_of_work.setText(_translate("tableWidget_metrics", "Программа анализа перехваченных пакетов"))
        self.pushBatton_start_capture.setText(_translate("tableWidget_metrics", "Начать"))
        self.pushButton_stop_capture.setText(_translate("tableWidget_metrics", "Прекратить"))
        self.label_name_capture_display.setText(_translate("tableWidget_metrics", "Перехваченные пакеты"))
        self.label_input_data.setText(_translate("tableWidget_metrics", "Входные данные"))
        item = self.tableWidget_metric.horizontalHeaderItem(0)
        item.setText(_translate("tableWidget_metrics", "Время"))
        item = self.tableWidget_metric.horizontalHeaderItem(1)
        item.setText(_translate("tableWidget_metrics", "Всего пакетов"))
        item = self.tableWidget_metric.horizontalHeaderItem(2)
        item.setText(_translate("tableWidget_metrics", "Входящие(пак)"))
        item = self.tableWidget_metric.horizontalHeaderItem(3)
        item.setText(_translate("tableWidget_metrics", "Исходящие(пак)"))
        item = self.tableWidget_metric.horizontalHeaderItem(4)
        item.setText(_translate("tableWidget_metrics", "TCP (сегм)")) # Изменено для соответствия main.py
        item = self.tableWidget_metric.horizontalHeaderItem(5)
        item.setText(_translate("tableWidget_metrics", "UDP(сегм)"))
        item = self.tableWidget_metric.horizontalHeaderItem(6)
        item.setText(_translate("tableWidget_metrics", "Фрагменты(пак)"))
        item = self.tableWidget_metric.horizontalHeaderItem(7)
        item.setText(_translate("tableWidget_metrics", "Multicast(пак)"))
        item = self.tableWidget_metric.horizontalHeaderItem(8)
        item.setText(_translate("tableWidget_metrics", "Интенсивность(пак/с)")) # Изменено для соответствия main.py
        self.label_data_statistics_of_capture_traffic.setText(_translate("tableWidget_metrics", "Данные статистики, собранные с перехваченного трафика"))
        self.label_name_graph_of_intensivity.setText(_translate("tableWidget_metrics", "График интенсивности пакетов"))
        self.label_name_graph_of_input_output_traffic.setText(_translate("tableWidget_metrics", "График исходящего/входящего трафика"))
        self.label_name_tcp_udp_segments_sootcnocheniy.setText(_translate("tableWidget_metrics", "Соотношение UDP/TCP сегментов"))
        self.pushButton_save_in_file.setText(_translate("tableWidget_metrics", "Сохранить данные"))
        self.pushBatton_finish_work.setText(_translate("tableWidget_metrics", "Закрыть программу"))
        self.label_name_time_of_capture.setText(_translate("tableWidget_metrics", "Период времени захвата пакетов"))
        self.label_interface_of_capture.setText(_translate("tableWidget_metrics", "Интерфейс захвата:"))
        self.label_name_network_capture.setText(_translate("tableWidget_metrics", "Сеть захвата:"))


# Добавляем класс TextEditLogger в этот файл
class TextEditLogger(logging.Handler):
    def __init__(self, widget):
        super().__init__()
        self.widget = widget
        self.widget.setReadOnly(True)
        # Устанавливаем форматтер для этого обработчика
        self.setFormatter(logging.Formatter('%(asctime)s - %(levelname)s - %(name)s - %(funcName)s - Line:%(lineno)d - %(message)s'))

    def emit(self, record):
        msg = self.format(record)
        # Используем appendPlainText для добавления текста в конце и прокрутки
        self.widget.appendPlainText(msg)
        # Автоматическая прокрутка к концу
        self.widget.verticalScrollBar().setValue(self.widget.verticalScrollBar().maximum())